Version 4
SHEET 1 3180 1428
WIRE 2864 64 2864 32
WIRE -960 96 -1168 96
WIRE -896 96 -960 96
WIRE -784 96 -832 96
WIRE -688 96 -784 96
WIRE -576 96 -688 96
WIRE -448 96 -576 96
WIRE 64 96 -16 96
WIRE 80 96 64 96
WIRE 176 96 160 96
WIRE 272 96 176 96
WIRE 448 96 400 96
WIRE 528 96 448 96
WIRE 592 96 528 96
WIRE 816 96 672 96
WIRE -784 112 -784 96
WIRE -688 112 -688 96
WIRE -448 112 -448 96
WIRE -16 112 -16 96
WIRE -16 112 -448 112
WIRE 448 128 448 96
WIRE 592 128 592 96
WIRE 672 128 672 96
WIRE 672 128 592 128
WIRE 2672 176 2656 176
WIRE 2736 176 2672 176
WIRE 2864 176 2864 128
WIRE 2864 176 2816 176
WIRE 2896 176 2864 176
WIRE 2944 176 2896 176
WIRE -784 192 -784 176
WIRE -784 192 -848 192
WIRE -688 192 -688 176
WIRE -688 192 -784 192
WIRE 336 192 336 144
WIRE 816 192 816 176
WIRE -1168 208 -1168 96
WIRE -848 208 -848 192
WIRE -784 208 -784 192
WIRE -688 208 -688 192
WIRE 2256 208 2224 208
WIRE 2400 208 2336 208
WIRE 336 240 336 192
WIRE 448 240 448 208
WIRE 448 240 336 240
WIRE 2944 256 2944 176
WIRE -960 288 -960 96
WIRE -896 288 -960 288
WIRE -784 288 -784 272
WIRE -784 288 -832 288
WIRE -688 288 -688 272
WIRE -688 288 -784 288
WIRE -528 288 -688 288
WIRE 336 304 336 240
WIRE 608 304 336 304
WIRE 864 304 688 304
WIRE 960 304 864 304
WIRE 1088 304 1040 304
WIRE 1616 304 1408 304
WIRE 1776 304 1696 304
WIRE 1872 304 1776 304
WIRE 1920 304 1872 304
WIRE 2400 320 2400 208
WIRE 1776 336 1776 304
WIRE 2672 336 2672 176
WIRE 2704 336 2672 336
WIRE 64 352 64 96
WIRE 176 352 176 96
WIRE 1088 352 1088 304
WIRE 2816 352 2768 352
WIRE 2928 352 2896 352
WIRE 2944 352 2944 336
WIRE 2944 352 2928 352
WIRE 2704 368 2576 368
WIRE 736 384 736 352
WIRE 864 384 864 304
WIRE 864 384 848 384
WIRE 848 400 848 384
WIRE 848 400 768 400
WIRE 2288 400 2288 336
WIRE 336 416 336 304
WIRE 384 416 336 416
WIRE 560 416 464 416
WIRE 576 416 560 416
WIRE 704 416 656 416
WIRE 1408 416 1408 304
WIRE 2128 416 2048 416
WIRE 2224 416 2224 208
WIRE 2224 416 2208 416
WIRE 2256 416 2224 416
WIRE 848 432 768 432
WIRE 1776 432 1776 400
WIRE 2400 432 2400 320
WIRE 2400 432 2320 432
WIRE 2928 432 2928 352
WIRE -1520 448 -1616 448
WIRE -1312 448 -1392 448
WIRE -1296 448 -1312 448
WIRE -528 448 -528 416
WIRE -432 448 -432 416
WIRE -336 448 -336 416
WIRE 64 448 64 432
WIRE 64 448 -32 448
WIRE 96 448 64 448
WIRE 176 448 176 432
WIRE 176 448 128 448
WIRE 240 448 176 448
WIRE 848 448 848 432
WIRE 864 448 848 448
WIRE 2256 448 2208 448
WIRE -1296 480 -1296 448
WIRE -32 480 -32 448
WIRE 240 480 240 448
WIRE 736 480 736 448
WIRE 1920 480 1920 304
WIRE 2208 480 2208 448
WIRE 2656 480 2576 480
WIRE 2704 480 2656 480
WIRE 2864 480 2784 480
WIRE 1216 496 1152 496
WIRE 1408 496 1408 416
WIRE 1408 496 1296 496
WIRE 2576 512 2576 480
WIRE 96 528 96 448
WIRE 128 528 128 448
WIRE 1152 528 1152 496
WIRE 2288 528 2288 464
WIRE 864 544 864 448
WIRE 928 544 864 544
WIRE 2928 560 2928 528
WIRE -1456 576 -1456 496
WIRE -1296 576 -1296 560
WIRE -1296 576 -1456 576
WIRE -32 576 -32 560
WIRE -1456 592 -1456 576
WIRE 1504 592 1504 512
WIRE 1408 608 1408 496
WIRE 1472 608 1408 608
WIRE 112 624 112 592
WIRE 240 624 240 560
WIRE 240 624 112 624
WIRE 1616 624 1536 624
WIRE 1664 624 1616 624
WIRE 1824 624 1744 624
WIRE 1840 624 1824 624
WIRE 1920 624 1920 560
WIRE 1920 624 1840 624
WIRE 2576 624 2576 592
WIRE 1472 640 1392 640
WIRE -1456 688 -1456 672
WIRE -464 704 -512 704
WIRE -464 736 -464 704
WIRE -352 736 -352 688
WIRE 112 736 112 624
WIRE 1504 736 1504 656
WIRE 560 752 560 416
WIRE -1520 768 -1600 768
WIRE -1328 768 -1392 768
WIRE -1312 768 -1328 768
WIRE -1312 784 -1312 768
WIRE 112 784 112 736
WIRE 144 784 112 784
WIRE 320 800 208 800
WIRE 368 800 320 800
WIRE 496 800 448 800
WIRE 144 816 48 816
WIRE 1840 816 1840 624
WIRE -464 832 -464 816
WIRE -352 848 -352 816
WIRE 816 848 816 832
WIRE 1488 864 1360 864
WIRE 1680 864 1488 864
WIRE 1776 864 1760 864
WIRE -1456 880 -1456 816
WIRE -1312 880 -1312 864
WIRE -1312 880 -1456 880
WIRE -1456 896 -1456 880
WIRE 1360 896 1360 864
WIRE 176 912 176 832
WIRE 560 928 560 848
WIRE 1840 976 1840 912
WIRE -1456 992 -1456 976
FLAG -336 528 0
FLAG 528 96 vout
FLAG -464 832 0
FLAG -32 576 0
FLAG -336 416 +16
FLAG 560 928 0
FLAG -352 848 0
FLAG 320 800 clim
FLAG 112 736 ctov
FLAG -528 528 0
FLAG -512 704 vset
FLAG 336 192 vadj
FLAG -432 528 0
FLAG -432 416 -16
FLAG 736 480 -16
FLAG 736 352 +16
FLAG 1088 352 0
FLAG -1328 768 +5
FLAG -208 304 +16
FLAG 176 768 0
FLAG 176 912 +12
FLAG 928 544 vset
FLAG 48 816 ilimset
FLAG -352 688 ilimset
FLAG -1168 288 0
FLAG -848 208 0
FLAG 816 192 0
FLAG -576 96 +rectified
FLAG -1616 448 +rectified
FLAG -1600 768 +rectified
FLAG -1456 688 0
FLAG -1456 992 0
FLAG -1312 448 +12a
FLAG 864 672 +16
FLAG 864 832 -16
FLAG 816 848 0
FLAG -672 528 0
FLAG -672 448 -12
FLAG -816 528 0
FLAG -816 448 +12
FLAG -528 288 -rectified
FLAG 1504 512 +16
FLAG 1504 736 -16
FLAG 1392 640 vset
FLAG 1152 528 0
FLAG 1616 624 opampout
FLAG 1824 624 post_1k
FLAG 1872 304 pos_out
FLAG 1408 416 neg_input
FLAG 1840 976 0
FLAG 1360 976 0
FLAG 2576 624 0
FLAG 2288 336 +16
FLAG 2288 528 -16
FLAG 2208 480 0
FLAG 2896 176 neg_out
FLAG 1488 864 pos_lim
FLAG 2656 480 neg_lim
FLAG 2048 416 vset
FLAG 2400 320 vset_inv
FLAG 2736 320 +16
FLAG 2736 384 -16
FLAG 2576 368 vset_inv
FLAG 2576 176 0
FLAG 2928 560 0
FLAG 1776 432 0
FLAG 2864 32 0
SYMBOL PowerProducts/LM317 336 96 R0
SYMATTR InstName U1
SYMBOL voltage -336 432 R0
SYMATTR InstName V1
SYMATTR Value 16
SYMBOL res 432 112 R0
SYMATTR InstName R1
SYMATTR Value 120
SYMBOL voltage -464 720 R0
SYMATTR InstName V2
SYMATTR Value .1
SYMBOL res 80 448 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 256 576 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 176 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1
SYMBOL res 192 448 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res -48 464 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL npn 496 752 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL Opamps/opamp 176 560 R90
SYMATTR InstName U3
SYMBOL res 464 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL voltage -352 720 R0
SYMATTR InstName V3
SYMATTR Value 300m
SYMBOL Comparators/LT1017 176 800 M180
SYMATTR InstName U2
SYMBOL voltage -528 432 R0
SYMATTR InstName V5
SYMATTR Value 5
SYMBOL res 368 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R8
SYMATTR Value 100
SYMBOL res 672 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL voltage -432 432 R0
SYMATTR InstName V4
SYMATTR Value -16
SYMBOL res 704 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 9k
SYMBOL res 1056 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL Opamps/LT1055 736 352 M0
SYMATTR InstName U5
SYMBOL diode -896 112 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4001
SYMBOL diode -832 272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value 1N4001
SYMBOL voltage -1168 192 R0
SYMATTR InstName V6
SYMATTR Value SINE(0 16.9 60)
SYMBOL cap -800 112 R0
SYMATTR InstName C1
SYMATTR Value 3300µ
SYMBOL cap -800 208 R0
SYMATTR InstName C2
SYMATTR Value 3300µ
SYMBOL load2 816 96 R0
SYMATTR InstName I1
SYMATTR Value PWL(0 50m 800m 350m)
SYMBOL cap -704 112 R0
SYMATTR InstName C3
SYMATTR Value 0
SYMBOL cap -704 208 R0
SYMATTR InstName C4
SYMATTR Value 0
SYMBOL PowerProducts/LM317 -1456 448 R0
SYMATTR InstName U4
SYMBOL PowerProducts/LM317 -1456 768 R0
SYMATTR InstName U6
SYMBOL res -1312 464 R0
SYMATTR InstName R12
SYMATTR Value 220
SYMBOL res -1328 768 R0
SYMATTR InstName R13
SYMATTR Value 220
SYMBOL res -1472 576 R0
SYMATTR InstName R14
SYMATTR Value 2000
SYMBOL res -1472 880 R0
SYMATTR InstName R15
SYMATTR Value 660
SYMBOL Opamps/LT1637 864 752 M0
SYMATTR InstName U7
SYMBOL voltage -672 432 R0
SYMATTR InstName V7
SYMATTR Value -12
SYMBOL voltage -816 432 R0
SYMATTR InstName V8
SYMATTR Value +12
SYMBOL Opamps/LT1055 1504 560 R0
SYMATTR InstName U8
SYMBOL res 1312 480 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL res 1712 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 9k
SYMBOL res 1904 464 R0
SYMATTR InstName R18
SYMATTR Value 100
SYMBOL res 1760 608 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL npn 1776 816 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res 1776 848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL voltage 1360 880 R0
SYMATTR InstName V9
SYMATTR Value PULSE(0 5 100m 10n 10n 100m)
SYMBOL Opamps/LT1055 2288 368 R0
SYMATTR InstName U9
SYMBOL res 2224 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL res 2352 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 10k
SYMBOL res 2912 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res 2800 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 10k
SYMBOL voltage 2576 496 R0
SYMATTR InstName V10
SYMATTR Value PULSE(0 -5 300m 10n 10n 100m)
SYMBOL res 2928 240 R0
SYMATTR InstName R25
SYMATTR Value 100
SYMBOL Opamps/LT1055 2736 288 R0
SYMATTR InstName U10
SYMBOL res 2832 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 9k
SYMBOL res 2672 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 1k
SYMBOL pnp 2864 432 R0
SYMATTR InstName Q4
SYMATTR Value 2N3906
SYMBOL cap 1760 336 R0
SYMATTR InstName C5
SYMATTR Value 10µ
SYMBOL cap 2880 128 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value 10µ
SYMBOL npn 2464 960 R0
SYMATTR InstName Q3
TEXT -48 -128 Left 2 ;.step dec param iload 350m 350m 1
TEXT -48 -160 Left 2 ;.dc V2 0 1.2 0.01
TEXT -40 -88 Left 2 !.lib opamp.sub
TEXT -456 -40 Left 2 !.tran 0 1 0 0.001
TEXT -48 -48 Left 2 ;.step param cbulk 2000u 7000u 1000u
